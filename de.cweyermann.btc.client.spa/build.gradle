
plugins {
  id "com.moowork.node" version "1.2.0"
  id "com.github.jlouns.cpe" version "0.5.0"
}

node {
  version = '7.7.2.0'
  npmVersion = '4.1.2'
  distBaseUrl = 'http://nodejs.org/dist'
  download = true
  workDir = file("${project.projectDir}/nodejs")
  nodeModulesDir = file("./node_modules")
  }
 
task buildAngular(type: NpmTask) {
  args = ["run", "ng", "build"]
}

task buildAndroid(type:CrossPlatformExec) {
	executable "./android/platforms/android/cordova/build"
	args "--release"
}

task copywww(type:Copy) {
	from 'dist'
	into 'android/www'
}

task release(type:Copy) {
	from 'android/platforms/android/build/outputs/apk'
	into 'release'
}

buildAndroid.dependsOn copywww
copywww.dependsOn buildAngular
release.dependsOn buildAndroid
buildAngular.dependsOn npmInstall

